steps:
- task: Go@0
  displayName: go get github.com/nats-io/nats-server
  inputs:
    arguments: github.com/nats-io/nats-server

- task: Powershell@2
  displayName: Include nats-server in path
  inputs:
    targetType: inline
    script: |
      Write-Host "GOBIN: $(GOBIN)"
      $resolvedGOBIN = Resolve-Path $(GOBIN) | Select -Expand Path
      Write-Host "Resolved form: $resolvedGOBIN"
      Write-Host "##vso[task.prependpath]$resolvedGOBIN"

- task: CmdLine@2
  displayName: Verify nats-server
  inputs:
    script: |
      nats-server -v

- task: CmdLine@2
  displayName: Verify nats-server.exe
  condition: eq(variables['Agent.OS'], 'Windows_NT')
  inputs:
    script: |
      nats-server.exe -v