steps:
- task: Go@0
  displayName: go get github.com/nats-io/nats-server
  inputs:
    arguments: github.com/nats-io/nats-server

- task: CmdLine@2
  displayName: Add nats-server to path (Unix)
  condition: ne(variables['Agent.OS'], 'Windows_NT')
  inputs:
    script: |
      echo "##vso[task.setvariable variable=PATH]$PATH:$GOBIN"

- task: CmdLine@2
  displayName: Add nats-server to path (Windows)
  condition: eq(variables['Agent.OS'], 'Windows_NT')
  inputs:
    script: |
      echo "##vso[task.setvariable variable=PATH]${env:PATH};%GOBIN%"

- task: CmdLine@2
  displayName: Verify nats-server
  inputs:
    script: |
      nats-server -v